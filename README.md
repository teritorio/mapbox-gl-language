# OpenMapTiles Language

Adds support for switching the language of your map style in [Mapbox GL JS](https://www.mapbox.com/mapbox-gl-js/) maps.

Requires [maplibre-gl-js](https://maplibre.org/projects/#js) or older [mapbox-gl-js](https://github.com/mapbox/mapbox-gl-js).

![Multiple language supported with style transforms](https://cloud.githubusercontent.com/assets/1288339/26266912/89b1b6ba-3cb5-11e7-9964-49f51290d627.gif)

_Automatic style transformations for different languages_

![Switch language based on user agent](https://cloud.githubusercontent.com/assets/1288339/26269878/742cdb02-3cc5-11e7-8479-c6ab3f0f8a82.gif)

_Switch language based on user agent_

**Example**

```javascript
var map = new mapboxgl.Map({
    container: 'map',
    style: 'https://raw.githubusercontent.com/openmaptiles/osm-bright-gl-style/gh-pages/style-local.json',
    center: [-77.0259, 38.9010],
    zoom: 9
});

// Add RTL support if you want to support Arabic
// mapboxgl.setRTLTextPlugin('https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.10.1/mapbox-gl-rtl-text.js');

var language = new openmaptiles_gl_language.OpenMapTilesLanguage();
map.addControl(language);

// Language can be set at initialization or later
language.setLanguage('es');
```

Check `examples/` for more usage examples.

## Usage

The project is bundled in several formats so you can use it everywhere.

If you don't know what format is better for you, choose UMD ;)

### UMD (Universal Module Definition)

To use in your HTML files:

```html
<script
  type="text/javascript"
  src="https://unpkg.com/@teritorio/openmaptiles-gl-language/dist/openmaptiles_gl_language.umd.production.min.js"
></script>
```

### CommonJS

To import the library in your bundled project:

```js
import { OpenMapTilesLanguage } from '@teritorio/openmaptiles-gl-language'

const languageControl = new OpenMapTilesLanguage({
    defaultLanguage: 'it',
})
```

### ES Module

```html
<script type="module">
  import { icon } from 'https://unpkg.com/@teritorio/openmaptiles-gl-language/dist/openmaptiles_gl_language.esm.js';

  icon(/* ... */);
</script>
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [OpenMapTilesLanguage](#openmaptileslanguage)
    -   [Parameters](#parameters)
    -   [setLanguage](#setlanguage)
        -   [Parameters](#parameters-1)

### OpenMapTilesLanguage

Create a new [Mapbox GL JS plugin](https://www.mapbox.com/blog/build-mapbox-gl-js-plugins/) that
modifies the layers of the map style to use the 'text-field' that matches the browser language.

#### Parameters

-   `options` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options to configure the plugin.
    -   `options.supportedLanguages` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** List of supported languages
    -   `options.languageField` **[RegExp](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp)** RegExp to match if a text-field is a language field (optional, default `/^name:/`)
    -   `options.getLanguageField` **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)?** Given a language choose the field in the vector tiles
    -   `options.languageSource` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Name of the source that contains the different languages.
    -   `options.defaultLanguage` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Name of the default language to initialize style after loading.
    -   `options.excludedLayerIds` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** Name of the layers that should be excluded from translation.

#### setLanguage

Explicitly change the language for a style.

##### Parameters

-   `language` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The language iso code

Returns **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** the modified style

## Develop

Run the linter and watch for changes to rebuild with browserify.

    npm install
    npm run test

## Languages

Showcasing the languages supported by OpenMapTiles.

-   [Your Browser language](https://teritorio.github.io/openmaptiles-gl-language/examples/browser.html)
-   [Arabic](https://teritorio.github.io/openmaptiles-gl-language/examples/ar.html)
-   [Chinese Simplified](https://teritorio.github.io/openmaptiles-gl-language/examples/zh.html)
-   [English](https://teritorio.github.io/openmaptiles-gl-language/examples/en.html)
-   [French](https://teritorio.github.io/openmaptiles-gl-language/examples/fr.html)
-   [German](https://teritorio.github.io/openmaptiles-gl-language/examples/de.html)
-   [Italian](https://teritorio.github.io/openmaptiles-gl-language/examples/it.html)
-   [Japanese](https://teritorio.github.io/openmaptiles-gl-language/examples/ja.html)
-   [Korean](https://teritorio.github.io/openmaptiles-gl-language/examples/ko.html)
-   [Multilingual](https://teritorio.github.io/openmaptiles-gl-language/examples/multilingual.html)
-   [Portuguese](https://teritorio.github.io/openmaptiles-gl-language/examples/pt.html)
-   [Russian](https://teritorio.github.io/openmaptiles-gl-language/examples/ru.html)
-   [Spanish](https://teritorio.github.io/openmaptiles-gl-language/examples/es.html)

Or [manual](https://teritorio.github.io/openmaptiles-gl-language/examples/manual.html) switch.

## Supported Styles

You can configure the plugin to support your own custom style using style transforms and custom language fields.
By default, this plugin works best with [OpenMapTiles styles](https://openmaptiles.org/styles/) or derived.
